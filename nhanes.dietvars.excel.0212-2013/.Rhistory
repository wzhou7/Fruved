trim <- function (x) gsub("^\\s+|\\s+$", "", x)
library(eeptools)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/0_Code/lib")
source("function_drop_duplicates.R")
source("function_FV.R")
source("function_IPAQ.R")
source("function_Stress.R")
source("function_BECS.R")
source("function_FS.R")
source("function_CEPS_HS.R")
source("function_DSQ.R")
source("function_Ncifat.R")
source("function_get_score.R")
source("function_Readiness_HS.R")
source("function_get_race.R")
source("function_age.R")
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
library(eeptools)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/0_Code/lib")
source("function_drop_duplicates.R")
source("function_FV.R")
source("function_IPAQ.R")
source("function_Stress.R")
source("function_BECS.R")
source("function_FS.R")
source("function_CEPS_HS.R")
source("function_DSQ.R")
source("function_Ncifat.R")
source("function_get_score.R")
source("function_Readiness_HS.R")
source("function_get_race.R")
source("function_age.R")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/2_Drop_Header")
data <- read.csv("HS_Survey__Fall_2017_FLORIDA.csv")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/2_Fall17/3_Cleaned")
df <- read.delim("HS_Cleaned_17.tsv",sep="\t")
###############################
########Convert VarName########
###############################
ind1 <- which(names(data)=="IPAQ6")
ind2 <- which(names(data)=="SLEEP4")
if((ind2 - ind1)==15){
names(data)[(ind1+1):(ind2-1)] <- paste0("STRESS_",c(1,2,3,5:15))
}
ind <- which(names(data)=="WT1")
names(data)[ind-2] <- "HT1"
names(data)[ind-1] <- "HT2"
ind <- which(names(data)=="PRIORITIES16_TEXT")
names(data)[(ind-16):(ind-1)] <- paste0("PRIORITIES",1:16)
#Covert V1-V10
names(data)[which(names(data)=="V1")] <- "ResponseID"
names(data)[which(names(data)=="V8")] <- "StartDate"
names(data)[which(names(data)=="V9")] <- "EndDate"
names(data)[which(names(data)=="V10")] <- "Finished"
#Convert FS
ind <- which(names(data)=="FS_TEXT")
names(data)[(ind+1):(ind+9)] <- paste0("FS_Student",1:9)
#Convert RELAT2
ind1 <- which(names(data)=="RELAT1")
ind2 <- which(names(data)=="RELAT3")
names(data)[(ind1+1):(ind2-1)] <- paste0("RELAT2_",1:3)
names(data)[(ind2+1):(ind2+2)] <- paste0("RELAT4_",1:2)
#Convert Cook4
ind <- which(names(data)=="Cook3")
names(data)[(ind+1):(ind+4)] <- paste0("Cook4_",1:4)
#Convert FCP
ind <- which(names(data)=="FCP1_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP1_",c(1:32))
ind <- which(names(data)=="FCP2_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP2_",c(1:32))
#Convert P
ind <- which(names(data)=="RELAT1")
names(data)[(ind-10):(ind-1)] <- paste0("P",c(1:10))
###############################
########Drop duplicates########
###############################
sum(data$ID_3!=data$ID_4) #0, ok!
data <- data[!(data$ResponseID %in% c("R_234s6K8DbXC27Eu","R_3EgmV2r4mpmqQZ7")),]
data <- drop_duplicates(data)
###############################
############Scoring############
###############################
data <- get_score(data)
vars1 <- c("V2","V3","V4","V5","V6","V7")
ind1 <- which(names(data)=="SC0_0")
ind2 <- which(names(data)=="FS_SCORE_faculty")
vars2 <- names(data)[ind1:ind2]
vars3 <- c("ID_1_1_TEXT","ID_1_2_TEXT","ID_2_1_TEXT","ID_2_2_TEXT","ID_3",
"ID_4","DEM2AGE_MONTH","DEM2AGE_DATE","DEM2AGE_YEAR","ID",
"Futureopp2",
"LocationLatitude","LocationLongitude","LocationAccuracy",
"DEM2AGE_YEAR_NORM","DEM2AGE_MONTH_NORM","DEM2AGE_DATE_NROM",
"DOB","ageinmonth","ageinmonth_round","HT1_NORM","HT2_NORM")
head(data[,var3])
head(data[,vars3])
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
library(eeptools)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/0_Code/lib")
source("function_drop_duplicates.R")
source("function_FV.R")
source("function_IPAQ.R")
source("function_Stress.R")
source("function_BECS.R")
source("function_FS.R")
source("function_CEPS_HS.R")
source("function_DSQ.R")
source("function_Ncifat.R")
source("function_get_score.R")
source("function_Readiness_HS.R")
source("function_get_race.R")
source("function_age.R")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/2_Drop_Header")
data <- read.csv("HS_Survey__Fall_2017_FLORIDA.csv")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/2_Fall17/3_Cleaned")
df <- read.delim("HS_Cleaned_17.tsv",sep="\t")
###############################
########Convert VarName########
###############################
ind1 <- which(names(data)=="IPAQ6")
ind2 <- which(names(data)=="SLEEP4")
if((ind2 - ind1)==15){
names(data)[(ind1+1):(ind2-1)] <- paste0("STRESS_",c(1,2,3,5:15))
}
ind <- which(names(data)=="WT1")
names(data)[ind-2] <- "HT1"
names(data)[ind-1] <- "HT2"
ind <- which(names(data)=="PRIORITIES16_TEXT")
names(data)[(ind-16):(ind-1)] <- paste0("PRIORITIES",1:16)
#Covert V1-V10
names(data)[which(names(data)=="V1")] <- "ResponseID"
names(data)[which(names(data)=="V8")] <- "StartDate"
names(data)[which(names(data)=="V9")] <- "EndDate"
names(data)[which(names(data)=="V10")] <- "Finished"
#Convert FS
ind <- which(names(data)=="FS_TEXT")
names(data)[(ind+1):(ind+9)] <- paste0("FS_Student",1:9)
#Convert RELAT2
ind1 <- which(names(data)=="RELAT1")
ind2 <- which(names(data)=="RELAT3")
names(data)[(ind1+1):(ind2-1)] <- paste0("RELAT2_",1:3)
names(data)[(ind2+1):(ind2+2)] <- paste0("RELAT4_",1:2)
#Convert Cook4
ind <- which(names(data)=="Cook3")
names(data)[(ind+1):(ind+4)] <- paste0("Cook4_",1:4)
#Convert FCP
ind <- which(names(data)=="FCP1_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP1_",c(1:32))
ind <- which(names(data)=="FCP2_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP2_",c(1:32))
#Convert P
ind <- which(names(data)=="RELAT1")
names(data)[(ind-10):(ind-1)] <- paste0("P",c(1:10))
###############################
########Drop duplicates########
###############################
sum(data$ID_3!=data$ID_4) #0, ok!
data <- data[!(data$ResponseID %in% c("R_234s6K8DbXC27Eu","R_3EgmV2r4mpmqQZ7")),]
data <- drop_duplicates(data)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
library(eeptools)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/0_Code/lib")
source("function_drop_duplicates.R")
source("function_FV.R")
source("function_IPAQ.R")
source("function_Stress.R")
source("function_BECS.R")
source("function_FS.R")
source("function_CEPS_HS.R")
source("function_DSQ.R")
source("function_Ncifat.R")
source("function_get_score.R")
source("function_Readiness_HS.R")
source("function_get_race.R")
source("function_age.R")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/2_Drop_Header")
data <- read.csv("HS_Survey__Fall_2017_FLORIDA.csv")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/2_Fall17/3_Cleaned")
df <- read.delim("HS_Cleaned_17.tsv",sep="\t")
###############################
########Convert VarName########
###############################
ind1 <- which(names(data)=="IPAQ6")
ind2 <- which(names(data)=="SLEEP4")
if((ind2 - ind1)==15){
names(data)[(ind1+1):(ind2-1)] <- paste0("STRESS_",c(1,2,3,5:15))
}
ind <- which(names(data)=="WT1")
names(data)[ind-2] <- "HT1"
names(data)[ind-1] <- "HT2"
ind <- which(names(data)=="PRIORITIES16_TEXT")
names(data)[(ind-16):(ind-1)] <- paste0("PRIORITIES",1:16)
#Covert V1-V10
names(data)[which(names(data)=="V1")] <- "ResponseID"
names(data)[which(names(data)=="V8")] <- "StartDate"
names(data)[which(names(data)=="V9")] <- "EndDate"
names(data)[which(names(data)=="V10")] <- "Finished"
#Convert FS
ind <- which(names(data)=="FS_TEXT")
names(data)[(ind+1):(ind+9)] <- paste0("FS_Student",1:9)
#Convert RELAT2
ind1 <- which(names(data)=="RELAT1")
ind2 <- which(names(data)=="RELAT3")
names(data)[(ind1+1):(ind2-1)] <- paste0("RELAT2_",1:3)
names(data)[(ind2+1):(ind2+2)] <- paste0("RELAT4_",1:2)
#Convert Cook4
ind <- which(names(data)=="Cook3")
names(data)[(ind+1):(ind+4)] <- paste0("Cook4_",1:4)
#Convert FCP
ind <- which(names(data)=="FCP1_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP1_",c(1:32))
ind <- which(names(data)=="FCP2_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP2_",c(1:32))
#Convert P
ind <- which(names(data)=="RELAT1")
names(data)[(ind-10):(ind-1)] <- paste0("P",c(1:10))
###############################
########Drop duplicates########
###############################
sum(data$ID_3!=data$ID_4) #0, ok!
data <- data[!(data$ResponseID %in% c("R_234s6K8DbXC27Eu","R_3EgmV2r4mpmqQZ7")),]
data <- drop_duplicates(data)
###############################
############Scoring############
###############################
data <- get_score(data)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/2_Fall17/0_Code/nhanes.dietvars.excel.0212-2013")
Dsqcertyp <- read.csv("Dsqcertyp1.csv")
Dsqcertyp$Name <- trim(Dsqcertyp$Name)
Cereal <- read.csv("cereal.attributes.by.foodcode.csv")
Cereal$Cereal_Name <- trim(Cereal$Cereal_Name)
PortionSize <- read.csv("portion.size.csv")
Coefficients <- read.csv("regression.coefficients.csv")
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
library(eeptools)
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/0_Code/lib")
source("function_drop_duplicates.R")
source("function_FV.R")
source("function_IPAQ.R")
source("function_Stress.R")
source("function_BECS.R")
source("function_FS.R")
source("function_CEPS_HS.R")
source("function_DSQ.R")
source("function_Ncifat.R")
source("function_get_score.R")
source("function_Readiness_HS.R")
source("function_get_race.R")
source("function_age.R")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/3_LN_171122/2_Drop_Header")
data <- read.csv("HS_Survey__Fall_2017_FLORIDA.csv")
setwd("/Users/Wangcheng/Google Drive/Fruved Data/High School/2_Fall17/3_Cleaned")
df <- read.delim("HS_Cleaned_17.tsv",sep="\t")
###############################
########Convert VarName########
###############################
ind1 <- which(names(data)=="IPAQ6")
ind2 <- which(names(data)=="SLEEP4")
if((ind2 - ind1)==15){
names(data)[(ind1+1):(ind2-1)] <- paste0("STRESS_",c(1,2,3,5:15))
}
ind <- which(names(data)=="WT1")
names(data)[ind-2] <- "HT1"
names(data)[ind-1] <- "HT2"
ind <- which(names(data)=="PRIORITIES16_TEXT")
names(data)[(ind-16):(ind-1)] <- paste0("PRIORITIES",1:16)
#Covert V1-V10
names(data)[which(names(data)=="V1")] <- "ResponseID"
names(data)[which(names(data)=="V8")] <- "StartDate"
names(data)[which(names(data)=="V9")] <- "EndDate"
names(data)[which(names(data)=="V10")] <- "Finished"
#Convert FS
ind <- which(names(data)=="FS_TEXT")
names(data)[(ind+1):(ind+9)] <- paste0("FS_Student",1:9)
#Convert RELAT2
ind1 <- which(names(data)=="RELAT1")
ind2 <- which(names(data)=="RELAT3")
names(data)[(ind1+1):(ind2-1)] <- paste0("RELAT2_",1:3)
names(data)[(ind2+1):(ind2+2)] <- paste0("RELAT4_",1:2)
#Convert Cook4
ind <- which(names(data)=="Cook3")
names(data)[(ind+1):(ind+4)] <- paste0("Cook4_",1:4)
#Convert FCP
ind <- which(names(data)=="FCP1_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP1_",c(1:32))
ind <- which(names(data)=="FCP2_34")
names(data)[(ind-32):(ind-1)] <- paste0("FCP2_",c(1:32))
#Convert P
ind <- which(names(data)=="RELAT1")
names(data)[(ind-10):(ind-1)] <- paste0("P",c(1:10))
###############################
########Drop duplicates########
###############################
sum(data$ID_3!=data$ID_4) #0, ok!
data <- data[!(data$ResponseID %in% c("R_234s6K8DbXC27Eu","R_3EgmV2r4mpmqQZ7")),]
data <- drop_duplicates(data)
###############################
############Scoring############
###############################
data <- get_score(data)
head(data[,vars3])
